<ng-container [formGroup]="FormGroup">

  <ng-container
    *ngIf="arrayName"
    [formArrayName]="arrayName"
  >
    <ng-container
      [formGroupName]="groupName"
    >
      <nz-form-item>
        <nz-form-label
          [nzSpan]="isHorizontal ? 4 : null"
          [nzRequired]="option.required"
        >{{option.label}}</nz-form-label>
        <nz-form-control
          [nzSpan]="isHorizontal ? 14 : null"
        >
  
          <nz-range-picker
            *ngIf="!option.derivativeType"
            [nzFormat]="option.dateFormat"
            [nzShowTime]="option.showTime"
            [nzValueFormat]="option.valueFormat"
            [formControlName]="option.key"
          ></nz-range-picker>
  
          <nz-date-picker
            *ngIf="option.derivativeType === 'date'"
            [nzFormat]="option.dateFormat"
            [nzShowTime]="option.showTime"
            [nzValueFormat]="option.valueFormat"
            [formControlName]="option.key"
          ></nz-date-picker>
  
          <nz-month-picker
            *ngIf="option.derivativeType === 'month'"
            [nzFormat]="option.dateFormat || 'yyyy-MM'"
            [nzValueFormat]="option.valueFormat"
            [formControlName]="option.key"
          ></nz-month-picker>
  
          <nz-year-picker
            *ngIf="option.derivativeType === 'year'"
            [nzFormat]="option.dateFormat || 'yyyy'"
            [nzValueFormat]="option.valueFormat"
            [formControlName]="option.key"
          ></nz-year-picker>
  
          <nz-week-picker
            *ngIf="option.derivativeType === 'week'"
            [nzFormat]="option.dateFormat"
            [nzValueFormat]="option.valueFormat"
            [formControlName]="option.key"
          ></nz-week-picker>

          <ng-container
            *ngIf="option.extTemplate"
          >
            <div class="fd-ext-template-box" >
              <ng-container
                [ngTemplateOutlet]="option.extTemplate"
              ></ng-container>
            </div>
          </ng-container>
  
          <fd-form-error
            *ngIf="option.errorMsg"
            [option]="option"
            [arrayKey] = "arrayName"
            [groupKey] = "groupName"
          ></fd-form-error>
        </nz-form-control>
      </nz-form-item>
    </ng-container>
  </ng-container>

  <ng-container
    *ngIf="!arrayName && groupName"
    [formGroupName]="groupName"
  >
    <nz-form-item>
      <nz-form-label
        [nzSpan]="isHorizontal ? 4 : null"
        [nzRequired]="option.required"
      >{{option.label}}</nz-form-label>
      <nz-form-control
        [nzSpan]="isHorizontal ? 14 : null"
      >

        <nz-range-picker
          *ngIf="!option.derivativeType"
          [nzFormat]="option.dateFormat"
          [nzShowTime]="option.showTime"
          [nzValueFormat]="option.valueFormat"
          [formControlName]="option.key"
        ></nz-range-picker>

        <nz-date-picker
          *ngIf="option.derivativeType === 'date'"
          [nzFormat]="option.dateFormat"
          [nzShowTime]="option.showTime"
          [nzValueFormat]="option.valueFormat"
          [formControlName]="option.key"
        ></nz-date-picker>

        <nz-month-picker
          *ngIf="option.derivativeType === 'month'"
          [nzFormat]="option.dateFormat || 'yyyy-MM'"
          [nzValueFormat]="option.valueFormat"
          [formControlName]="option.key"
        ></nz-month-picker>

        <nz-year-picker
          *ngIf="option.derivativeType === 'year'"
          [nzFormat]="option.dateFormat || 'yyyy'"
          [nzValueFormat]="option.valueFormat"
          [formControlName]="option.key"
        ></nz-year-picker>

        <nz-week-picker
          *ngIf="option.derivativeType === 'week'"
          [nzFormat]="option.dateFormat"
          [nzValueFormat]="option.valueFormat"
          [formControlName]="option.key"
        ></nz-week-picker>

        <ng-container
          *ngIf="option.extTemplate"
        >
          <div class="fd-ext-template-box" >
            <ng-container
              [ngTemplateOutlet]="option.extTemplate"
            ></ng-container>
          </div>
        </ng-container>

        <fd-form-error
          *ngIf="option.errorMsg"
          [option]="option"
          [groupKey] = "groupName"
        ></fd-form-error>
      </nz-form-control>
    </nz-form-item>
  </ng-container>

  <ng-container
    *ngIf="!arrayName && !groupName"
  >
    <nz-form-item>
      <nz-form-label
        [nzSpan]="isHorizontal ? 4 : null"
        [nzRequired]="option.required"
      >{{option.label}}</nz-form-label>
      <nz-form-control
        [nzSpan]="isHorizontal ? 14 : null"
      >

        <nz-range-picker
          *ngIf="!option.derivativeType"
          [nzFormat]="option.dateFormat"
          [nzShowTime]="option.showTime"
          [nzValueFormat]="option.valueFormat"
          [formControlName]="option.key"
        ></nz-range-picker>

        <nz-date-picker
          *ngIf="option.derivativeType === 'date'"
          [nzFormat]="option.dateFormat"
          [nzShowTime]="option.showTime"
          [nzValueFormat]="option.valueFormat"
          [formControlName]="option.key"
        ></nz-date-picker>

        <nz-month-picker
          *ngIf="option.derivativeType === 'month'"
          [nzFormat]="option.dateFormat || 'yyyy-MM'"
          [nzValueFormat]="option.valueFormat"
          [formControlName]="option.key"
        ></nz-month-picker>

        <nz-year-picker
          *ngIf="option.derivativeType === 'year'"
          [nzFormat]="option.dateFormat || 'yyyy'"
          [nzValueFormat]="option.valueFormat"
          [formControlName]="option.key"
        ></nz-year-picker>

        <nz-week-picker
          *ngIf="option.derivativeType === 'week'"
          [nzFormat]="option.dateFormat"
          [nzValueFormat]="option.valueFormat"
          [formControlName]="option.key"
        ></nz-week-picker>

        <ng-container
          *ngIf="option.extTemplate"
        >
          <div class="fd-ext-template-box" >
            <ng-container
              [ngTemplateOutlet]="option.extTemplate"
            ></ng-container>
          </div>
        </ng-container>
    
        <fd-form-error
          *ngIf="option.errorMsg"
          [option]="option"
        ></fd-form-error>
      </nz-form-control>
    </nz-form-item>
  </ng-container>

</ng-container>

<fd-form-item-distribution
  *ngIf = "option.formGroup && FormGroup.get(option.key).value && option.formGroup[FormGroup.get(option.key).value]"
  [group]="FormGroup"
  [options] = "option.formGroup[FormGroup.get(option.key).value].groups"
  [groupName] = "option.formGroup[FormGroup.get(option.key).value].key"
></fd-form-item-distribution>

<fd-form-array-distribution
  *ngIf = "option.formArray && FormGroup.get(option.key).value && option.formArray[FormGroup.get(option.key).value]"
  [group]="FormGroup"
  [options] = "option.formArray[FormGroup.get(option.key).value].groupsArr"
  [arrayName] = "option.formArray[FormGroup.get(option.key).value].key"
></fd-form-array-distribution>